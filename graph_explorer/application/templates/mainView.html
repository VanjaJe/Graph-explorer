    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

            <style>
            .block {
                cursor: pointer;
                color: #5b5b5b;
                text-align: center;
                box-sizing: border-box; 
                background-color: #5b5b5b;
                border: 2px solid #003B73;
                border-radius: 5px; 
            }

            .link {
                fill: none;
                stroke: #003B73;
                stroke-width: 1.5px;
            }
            </style>

            <script type="text/javascript">

            var current = null;
            var nodesGraph = JSON.parse("{\u00220\u0022: {\u0022id\u0022: \u0022ID_0\u0022, \u0022attributes\u0022: [\u0022name: Sergey Prokopyev\u0022, \u0022lastname: sonja\u0022, \u0022hobbies: [football, tennis]\u0022, \u0022friends: 2\u0022], \u0022weight\u0022: 1}, \u00221\u0022: {\u0022id\u0022: \u0022ID_1\u0022, \u0022attributes\u0022: [\u0022name: lastname\u0022, \u0022hobbies: [football, tennis]\u0022, \u0022friends: 1\u0022], \u0022weight\u0022: 1}, \u00222\u0022: {\u0022id\u0022: \u0022ID_2\u0022, \u0022attributes\u0022: [\u0022name: Frank Rubio\u0022, \u0022hobbies: [painting, singing]\u0022], \u0022weight\u0022: 1}}");
            var links= JSON.parse("[{\u0022source\u0022: 0, \u0022target\u0022: 1}]");

            links.forEach(function(link) {
                link.source = nodesGraph[link.source];
                link.target = nodesGraph[link.target];
            });

            var force = d3.layout.force()
                .size([4000, 2000])
                .nodes(d3.values(nodesGraph))
                .links(links)
                .on("tick", tick)
                .linkDistance(2000)  
                .charge(-1000)
                .gravity(0.1)
                .start();

            var svg = d3.select('#mainView').call(d3.behavior.zoom().on("zoom", function () {
                svg.attr("transform", " translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")")
            })).append('g');

            var padding = 20; 
            var alpha = 0.1;  

            // add the links
            var link = svg.selectAll('.link')
                .data(links)
                .enter().append('line')
                .attr('class', 'link');

            // add the block nodes
            var blockNode = svg.selectAll('.block')
                .data(force.nodes())
                .enter().append('g')
                .attr('class', 'block')
                .attr('id', function(d) {
                    return d.id;
                })
                .on('click', function(d) {
                    nodeClick(d);
                });

            blockNode.each(function(d) {
                var textLength = d.attributes.join(" ").length;
                var lineHeight = 15;  
                var lines = Math.ceil(textLength / 20);  
                var width = Math.max(100, textLength * 5);  

                d3.select(this).append('rect')
                    .attr('x', -width / 2)
                    .attr('y', -lines * lineHeight / 2)  
                    .attr('width', width)
                    .attr('height', lines * lineHeight)
                    .attr('fill', '#5b5b5b')  
                    .attr('stroke', '#003B73');

                d3.select(this).selectAll('text.attribute')
                    .data([d.id].concat(d.attributes))
                    .enter()
                    .append('text')
                    .attr('x', 0)
                    .attr('y', function(_, i) {
                        return -lines * lineHeight / 2 + 15 + i * lineHeight;  
                    })
                    .attr('text-anchor', 'middle')
                    .attr('font-size', 12)
                    .attr('font-family', 'poppins')
                    .attr('fill', 'white')
                    .text(function(attribute) {
                        return attribute;
                    });
            });

            function nodeClick(d) {
                var message = "ID: " + d.id + "\n";
                for (var i = 0; i < d.attributes.length; i++) {
                    message += d.attributes[i] + "\n";
                }
                alert(message);
            }

            function tick(e) {
                var k = 6 * e.alpha;
                force.nodes().forEach(function(o, i) {
                    o.y += k * (i & 1 ? 1 : -1);
                });

                force.nodes().forEach(function(o, i) {
                    force.nodes().forEach(function(d, j) {
                        if (i !== j) {
                            var deltaX = o.x - d.x;
                            var deltaY = o.y - d.y;
                            var distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                            var minDistance = o.radius + d.radius + padding;

                            if (distance < minDistance) {
                                var displacementX = (minDistance - distance) * (deltaX / distance) * alpha;
                                var displacementY = (minDistance - distance) * (deltaY / distance) * alpha;
                                o.x += displacementX;
                                o.y += displacementY;
                                d.x -= displacementX;
                                d.y -= displacementY;
                            }
                        }
                    });
                });

                blockNode.attr("transform", function(d) {
                    return "translate(" + d.x + "," + d.y + ")";
                });

                link.attr('x1', function(d) {
                    return d.source.x;
                })
                .attr('y1', function(d) {
                    return d.source.y;
                })
                .attr('x2', function(d) {
                    return d.target.x;
                })
                .attr('y2', function(d) {
                    return d.target.y;
                });
            }

                function ticked() {
                    // console.log("Ticked");
                    node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
                }
                
                function clicked(el){
                    console.log("USAO U CLICKED")
                    var message = "";
                    message += "ID:" + el.id + ", ";
                    if(current != null) {
                        d3.selectAll('.node').each(function(d){nodeView(d, '#595959');});
                        nodeView(nodesGraph[current.id.replace("ID_", "")], '#1a324c')
                    }
                    var node = nodesGraph[el.id.replace("ID_", "")];
                    current = node;
                    nodeView(current, '#1a324c')
                    for(var i=0;i<node.attributes.length;i++) {
                        message += node.attributes[i] + ", ";
                    }
                    console.log("PORUKA: " + message)
                    alert(message)
                    const wait = (n) => new Promise((resolve) => setTimeout(resolve, n));
                    const changeBackColor = async () => {
                      await wait(5000);
                      nodeView(node, '#595959')
                      node.attr('transform', function(d) {return 'translate(' + d.x + ',' + d.y + ')';}).call(force.drag);
                    };
                    // call the async function
                    changeBackColor();
                    node.attr('transform', function(d) {return 'translate(' + d.x + ',' + d.y + ')';}).call(force.drag);
                }
                

                </script>
